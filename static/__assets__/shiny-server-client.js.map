{"version":3,"sources":["../../client/src/__assets__/shiny-server-client.js"],"names":["reconnectWithbackoff","maxAttempts","waitFor","CONNECTING","OPEN","Shiny","shinyapp","$socket","includes","readyState","$scheduleReconnect","hideReconnectDialog","setTimeout","showReconnectDialog","preShinyInit","options","transports","createSocket","url","window","location","protocol","host","pathname","replace","$allowReconnect","$","document","on","SockJS"],"mappings":";;AACA,SAASA,oBAAT,CAA8BC,WAA9B,EAA2CC,OAA3C,EAAoD;AAClD,MAAMC,UAAU,GAAG,CAAnB;AACA,MAAMC,IAAI,GAAG,CAAb;;AAEA,MACEC,KAAK,CAACC,QAAN,CAAeC,OAAf,KAA2B,IAA3B,IACG,CAAC,CAACH,IAAD,EAAOD,UAAP,EAAmBK,QAAnB,CAA4BH,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBE,UAAnD,CAFN,EAGE;AACAJ,IAAAA,KAAK,CAACC,QAAN,CAAeI,kBAAf,CAAkC,IAAlC;AACD;;AAED,MAAIL,KAAK,CAACC,QAAN,CAAeC,OAAf,KAA2B,IAA3B,IAAmCF,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBE,UAAvB,KAAsCL,IAA7E,EAAmF;AACjFC,IAAAA,KAAK,CAACM,mBAAN;AACD,GAFD,MAEO,IAAIV,WAAW,GAAG,CAAlB,EAAqB;AAC1BW,IAAAA,UAAU,CAAC,YAAM;AACfZ,MAAAA,oBAAoB,CAAC,EAAEC,WAAH,EAAgBC,OAAO,GAAG,KAA1B,CAApB;AACD,KAFS,EAEPA,OAFO,CAAV;AAGD,GAJM,MAIA;AACLG,IAAAA,KAAK,CAACQ,mBAAN;AACD;AACF,C,CAED;;;AACA,SAASC,YAAT,GAAoD;AAAA,MAA9BC,OAA8B,uEAApB;AAAEC,IAAAA,UAAU,EAAE;AAAd,GAAoB;;AAClDX,EAAAA,KAAK,CAACY,YAAN,GAAqB,YAAM;AACzB,QAAIC,GAAG,aAAMC,MAAM,CAACC,QAAP,CAAgBC,QAAtB,eACLF,MAAM,CAACC,QAAP,CAAgBE,IADX,SAEJH,MAAM,CAACC,QAAP,CAAgBG,QAAhB,CAAyBC,OAAzB,CAAiC,WAAjC,EAA8C,EAA9C,CAFI,CAAP;AAGAN,IAAAA,GAAG,IAAI,cAAP;AACAb,IAAAA,KAAK,CAACC,QAAN,CAAemB,eAAf,GAAiC,IAAjC;AACAC,IAAAA,CAAC,CAACC,QAAD,CAAD,CAAYC,EAAZ,CAAe,oBAAf,EAAqC,YAAM;AACzC5B,MAAAA,oBAAoB,CAClB,EADkB,EAElB,IAFkB,CAApB;AAID,KALD;AAMA,WAAO,IAAI6B,MAAJ,CAAWX,GAAX,EAAgBH,OAAO,CAACC,UAAxB,EAAoC,EAApC,CAAP;AACD,GAbD;AAcD","sourcesContent":["\nfunction reconnectWithbackoff(maxAttempts, waitFor) {\n  const CONNECTING = 0;\n  const OPEN = 1;\n\n  if (\n    Shiny.shinyapp.$socket === null\n    || ![OPEN, CONNECTING].includes(Shiny.shinyapp.$socket.readyState)\n  ) {\n    Shiny.shinyapp.$scheduleReconnect(1000);\n  }\n\n  if (Shiny.shinyapp.$socket !== null && Shiny.shinyapp.$socket.readyState === OPEN) {\n    Shiny.hideReconnectDialog();\n  } else if (maxAttempts > 0) {\n    setTimeout(() => {\n      reconnectWithbackoff(--maxAttempts, waitFor * 1.125);\n    }, waitFor);\n  } else {\n    Shiny.showReconnectDialog();\n  }\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction preShinyInit(options = { transports: [] }) {\n  Shiny.createSocket = () => {\n    let url = `${window.location.protocol}//${\n      window.location.host\n    }${window.location.pathname.replace(/\\/[^\\/]*$/, '')}`;\n    url += '/__sockjs__/';\n    Shiny.shinyapp.$allowReconnect = true;\n    $(document).on('shiny:disconnected', () => {\n      reconnectWithbackoff(\n        50,\n        1000,\n      );\n    });\n    return new SockJS(url, options.transports, {});\n  };\n}\n"],"file":"shiny-server-client.js"}